@page "/{username}/profile"

@inject AuthenticationStateProvider AuthenticationStateProvider
@inject UserService UserService
@inject NavigationManager Navigation
@inject IStringLocalizer<Profile> Loc

<PageTitle>@Username</PageTitle>

@if (_user is null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="row d-lg-flex m-0 p-0">
        <div class="bg-light d-none d-lg-block col-lg-3 col-xxl-2 py-3">
            <div class="container justify-content-center">
                <Button Type="ButtonType.Button" Color="ButtonColor.Primary" Class="w-100" @onclick="@(() => Navigation.NavigateTo($"/{Username}/sets"))">@Loc["Sets"]</Button>
            </div>
        </div>

        <div class="content d-flex flex-column col-lg-9 col-xxl-10 px-0">
            <div class="d-flex flex-column py-4 border-bottom border-2" style="@profileBackgroundStyle">
                <div class="text-center my-3">
                    <div class="profile-image mx-auto">
                        <Image Src="https://demos.blazorbootstrap.com/images/placeholder.png" Class="w-100 h-100 border border-3 rounded-circle" IsResponsive="false" Alt="placeholder" />
                    </div>
                </div>
                <div class="text-center">
                    <span class="fs-2 text-shadow">@_user.Nickname</span>
                </div>
                <div class="text-center">
                    @String.Format($"{Loc["Level"]}", _user.GetLevel())
                </div>
            </div>

            <!-- BIG SCREEN -->
            <div class="d-none d-md-flex row h-100">
                <div class="col-9 pe-0">
                    <div class="p-3 border-bottom">
                        <h3>@Loc["AboutMe"]</h3>
                        <div>
                            Laci vagyok szeretem a nyelveket
                            <br />Barkit visszaigazolok jeloljetek nyugodtan
                        </div>
                    </div>
                </div>
                <div class="col-3 bg-primary h-100">

                </div>
            </div>
        </div>
    </div>
}

@code {

    [Parameter]
    public required string Username { get; set; }

    private User? _user;

    private string profileBackgroundStyle = "background-color: #BB2222;";

    protected async override Task OnParametersSetAsync()
    {
        _user = await UserService.GetUser(Username);
        if (_user is null)
        {
            Navigation.NavigateTo("page-not-found");
        }
    }
}
